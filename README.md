# Ransomware Monitor

An advanced file system monitoring tool designed to detect ransomware-like behaviors in real-time through entropy analysis, pattern detection, and behavioral heuristics.

## Technical Overview

This monitor implements a multi-layered approach to ransomware detection by analyzing file system events and applying several detection algorithms concurrently, based on established research in cybersecurity [1][2][3] and insights from various technical documents [4-11]. The documents are stored in file DOCS_ directory.

### Core Detection Methods

1. **Shannon Entropy Analysis**: Measures information randomness in modified files. Encrypted or compressed data typically exhibits higher entropy. Our implementation uses a threshold based on research by Scaife et al. [1], and considers findings from comparisons of entropy calculation methods [7] and cryptographic detection techniques [9].

2. **Sliding Window Entropy**: Detects localized encryption by analyzing entropy in fixed-size windows. This approach is detailed in studies like Kharraz et al. [3] and supported by general entropy analysis [7] and adaptive detection methodologies [8].

3. **Byte Distribution Analysis**: Compares file byte histograms against the uniform distribution characteristic of encrypted content, as explored by Garfinkel et al. [2], with further context from cryptographic detection papers [9].

4. **Change Rate Monitoring**: Tracks the frequency of file modifications. Ransomware typically exhibits an abnormally high rate of changes, consistent with behaviors described in research [4][5] and adaptive detection studies [8].

5. **Burst Detection**: Identifies clusters of suspicious activities within short time windows, a characteristic of automated attacks [5], and a concept relevant to adaptive behavioral analysis [8].

6. **Extension Monitoring**: Detects renaming to known ransomware extensions or pattern-based extensions based on databases of known ransomware behavior [6].

7. **File Content Analysis**: Identifies encryption signatures and binary patterns, leveraging techniques described in general ransomware detection guides [4] and specific cryptographic detection methods [9].

8. **Change Ratio Calculation**: Measures the proportion of file content changed, a method validated in multiple studies [3][4] and relevant to adaptive detection approaches [8].

### Architecture

The system employs an event-driven architecture using the Watchdog library to monitor file system events with minimal I/O overhead. Key components include:

- **DirectoryMonitor**: Sets up event observers and manages monitoring lifecycle
- **RansomwareEventHandler**: Processes file events and routes them to the detector
- **RansomwareDetector**: Implements core detection algorithms and maintains file baselines
- **Pattern Detection**: Specialized detection of encryption and hashing algorithm signatures

### Performance Metrics

- **Memory Usage**: O(n × m) where n = number of files, m = avg file size
- **Runtime Complexity**: O(n) for linear processing of file events
- **I/O Complexity**: Low, using OS-level notification APIs rather than polling

## How To Use

### Installation

1. Clone this repository:
```bash
git clone https://github.com/yourusername/ransomware_monitor.git
cd ransomware_monitor
```

2. Install dependencies:
```bash
pip install watchdog cryptography numpy
```

### Running the Monitor

To start monitoring a directory:

```bash
python run_monitor.py
```

When prompted, enter the full path of the directory you wish to monitor.

### Testing Tools

The repository includes several tools to test the monitor's capabilities:

1. List all available testing tools:
```bash
python test_tools.py list
```

2. Generate test files:
```bash
python test_tools.py generate_test_files
```

3. Simulate encryption (to test detection):
```bash
python test_tools.py encrypt_files
```

4. Decrypt previously encrypted test files:
```bash
python test_tools.py decrypt_files
```

5. Encrypt or decrypt an entire directory:
```bash
python test_tools.py folder_encryptor encrypt <directory_path>
python test_tools.py folder_encryptor decrypt <directory_path>
```

### Recommended Testing Workflow

1. Start by generating test files in a dedicated directory
2. Launch the ransomware monitor and point it to the test directory
3. In a separate terminal, run one of the encryption tools
4. Observe the alerts generated by the monitor
5. After testing, decrypt any encrypted files using the appropriate tools

## Configuration

Key settings can be adjusted in `core/config.py`:

- `HIGH_ENTROPY_THRESHOLD`: Threshold for identifying high entropy files (default: 7.0)
- `SLIDING_WINDOW_ENTROPY_THRESHOLD`: Threshold for window entropy analysis (default: 7.5)
- `BURST_THRESHOLD_SECONDS`: Time window for burst detection (default: 10)
- `BURST_THRESHOLD_COUNT`: Number of suspicious events to trigger a burst alert (default: 3)
- `TARGET_FILE_EXTENSIONS`: File types monitored for suspicious changes
- `ENCRYPTED_EXTENSIONS`: Known ransomware extensions to monitor

## Academic References

[1] Scaife, N., Carter, H., Traynor, P., & Butler, K. R. (2016). "CryptoLock (and Drop It): Stopping Ransomware Attacks on User Data." IEEE International Conference on Distributed Computing Systems (ICDCS).

[2] Garfinkel, S., Nelson, A., White, D., & Roussev, V. (2010). "Using purpose-built functions and block hashes to enable small block and sub-block forensics." Digital Investigation, 7, S13-S23.

[3] Kharraz, A., Robertson, W., Balzarotti, D., Bilge, L., & Kirda, E. (2015). "Cutting the Gordian Knot: A Look Under the Hood of Ransomware Attacks." DIMVA 2015, LNCS 9148, pp. 3–24.

[4] Guardian Digital (2023). "Ransomware Detection Techniques: Identifying and Blocking Attacks Before Encryption." (Based on `Guardian Digital (2023) Ransomware Detection Techniques.pdf`)

[5] NetApp BlueXP (2023). "Ransomware Detection Techniques and Best Practices for Protection." (Based on `NetApp BlueXP (2023) Ransomware Detection Techniques.pdf`)

[6] Picus Security (2023). "Detection and Prevention in the Final Phase of the Cyber Kill Chain." (Based on `picussecurity-com-resource-detection-and-prevention-in-the-final-phase-of-th....pdf`)

[7] *Comparison of Entropy Calculation Methods* (2022). (From `Comparison of Entropy Calculation Methods 2022.pdf`)

[8] *Adaptive Ransomware Detection* (ApplSci, 2024). (From `applsci_2024_Adaptive Ransomware Detection.pdf`)

[9] *Cryptographic Ransomware Encryption Detection*. (From `Cryptographic ransomware encryption detection.pdf`)

[10] *Not on my watch: ransomware detection* (joCybSec, 2025). (From `joCybSec_2025_Not_on_my_watch_ransomware_detection.pdf`)

[11] Cloudticity Blog. "Ransomware Detection." (From `blog-cloudticity-com-ransomware-detection....pdf`)

## License :

MIT License - Copyright (c) 2025
